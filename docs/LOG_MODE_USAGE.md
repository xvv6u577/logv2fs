# æ—¥å¿—æ¨¡å¼é…ç½®åŠŸèƒ½

æœ¬åŠŸèƒ½å…è®¸æ ¹æ® `GIN_MODE` ç¯å¢ƒå˜é‡è‡ªåŠ¨è®¾ç½®æ•°æ®åº“æ—¥å¿—çº§åˆ«ï¼Œä»¥ä¼˜åŒ–ä¸åŒç¯å¢ƒä¸‹çš„æ—¥å¿—è¾“å‡ºã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

æ ¹æ® `GIN_MODE` ç¯å¢ƒå˜é‡è‡ªåŠ¨è®¾ç½®ç›¸åº”çš„æ•°æ®åº“æ—¥å¿—çº§åˆ«ï¼š

| GIN_MODE | æ—¥å¿—çº§åˆ« | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|----------|----------|------|----------|
| `debug` | `logger.Info` | æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—ä¿¡æ¯ | å¼€å‘è°ƒè¯•ç¯å¢ƒ |
| `release` | `logger.Error` | åªæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ | ç”Ÿäº§ç¯å¢ƒ |
| `test` | `logger.Silent` | é™é»˜æ¨¡å¼ï¼Œä¸è¾“å‡ºæ—¥å¿— | æµ‹è¯•ç¯å¢ƒ |
| æœªè®¾ç½®/å…¶ä»– | `logger.Info` | é»˜è®¤è¯¦ç»†æ—¥å¿— | é»˜è®¤æƒ…å†µ |

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### 1. è®¾ç½®ç¯å¢ƒå˜é‡

åœ¨æ‚¨çš„ `.env` æ–‡ä»¶æˆ–ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­è®¾ç½®ï¼š

```bash
# å¼€å‘ç¯å¢ƒ
GIN_MODE=debug

# ç”Ÿäº§ç¯å¢ƒ  
GIN_MODE=release

# æµ‹è¯•ç¯å¢ƒ
GIN_MODE=test
```

### 2. å¯åŠ¨åº”ç”¨

```bash
# æ–¹æ³•1ï¼šé€šè¿‡ç¯å¢ƒå˜é‡æ–‡ä»¶
echo "GIN_MODE=debug" >> .env
./logv2fs httpserver

# æ–¹æ³•2ï¼šç›´æ¥è®¾ç½®ç¯å¢ƒå˜é‡
GIN_MODE=release ./logv2fs httpserver

# æ–¹æ³•3ï¼šæµ‹è¯•æ¨¡å¼
GIN_MODE=test ./logv2fs httpserver
```

## ğŸ¯ å®ç°åŸç†

ä»£ç å®ç°ä½äº `database/postgres_connection.go` æ–‡ä»¶ä¸­ï¼š

```go
// getLogLevel æ ¹æ® GIN_MODE ç¯å¢ƒå˜é‡è¿”å›å¯¹åº”çš„æ—¥å¿—çº§åˆ«
func getLogLevel() logger.LogLevel {
    ginMode := os.Getenv("GIN_MODE")
    
    switch ginMode {
    case "debug":
        return logger.Info  // å¼€å‘ç¯å¢ƒï¼Œæ˜¾ç¤ºè¯¦ç»†æ—¥å¿—
    case "release":
        return logger.Error // ç”Ÿäº§ç¯å¢ƒï¼Œåªæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    case "test":
        return logger.Silent // æµ‹è¯•ç¯å¢ƒï¼Œé™é»˜æ¨¡å¼
    default:
        // é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨ Info çº§åˆ«
        return logger.Info
    }
}
```

## ğŸ”§ ä»£ç å˜æ›´

ä¸»è¦ä¿®æ”¹ä½äº `InitPostgreSQL()` å‡½æ•°ï¼š

```go
// ä¹‹å‰ï¼ˆç¡¬ç¼–ç ï¼‰
Logger: logger.Default.LogMode(logger.Info),

// ä¹‹åï¼ˆåŠ¨æ€é…ç½®ï¼‰
Logger: logger.Default.LogMode(getLogLevel()),
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å¼€å‘ç¯å¢ƒ**ï¼šä½¿ç”¨ `debug` æ¨¡å¼æŸ¥çœ‹è¯¦ç»†çš„æ•°æ®åº“æ“ä½œæ—¥å¿—
2. **ç”Ÿäº§ç¯å¢ƒ**ï¼šä½¿ç”¨ `release` æ¨¡å¼å‡å°‘æ—¥å¿—è¾“å‡ºï¼Œæé«˜æ€§èƒ½
3. **æµ‹è¯•ç¯å¢ƒ**ï¼šä½¿ç”¨ `test` æ¨¡å¼ä¿æŒæµ‹è¯•è¾“å‡ºçš„æ¸…æ´
4. **CI/CD**ï¼šåœ¨ä¸åŒçš„éƒ¨ç½²é˜¶æ®µè‡ªåŠ¨è®¾ç½®ç›¸åº”çš„ `GIN_MODE`

## ğŸª æ•ˆæœç¤ºä¾‹

### Debug æ¨¡å¼è¾“å‡ºç¤ºä¾‹
```
2024/01/20 10:30:15 PostgreSQLè¿æ¥æˆåŠŸ
[GORM] 2024/01/20 10:30:15 SELECT * FROM user_traffic_logs WHERE email_as_id = $1
[GORM] 2024/01/20 10:30:15 INSERT INTO user_traffic_logs ...
```

### Release æ¨¡å¼è¾“å‡ºç¤ºä¾‹
```
2024/01/20 10:30:15 PostgreSQLè¿æ¥æˆåŠŸ
[ERROR] 2024/01/20 10:30:16 Connection failed: ...
```

### Test æ¨¡å¼è¾“å‡ºç¤ºä¾‹
```
(æ— æ•°æ®åº“ç›¸å…³æ—¥å¿—è¾“å‡º)
```

---

è¿™ä¸ªåŠŸèƒ½å®ç°äº† **Interactive Task Loop**ï¼ˆäº¤äº’å¼ä»»åŠ¡å¾ªç¯ï¼‰çš„è®¾è®¡ç†å¿µï¼Œæ ¹æ®ä¸åŒçš„è¿è¡Œç¯å¢ƒè‡ªåŠ¨è°ƒæ•´è¡Œä¸ºï¼Œæå‡äº†ç³»ç»Ÿçš„é€‚åº”æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ 